# CharacterForge â€” Permission Patch
$root = "C:\Users\dmchris\Desktop\CharacterForge"
Write-Host "Applying permission patch..." -ForegroundColor Cyan

# routes\dm.py
$b = "ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwpmcm9tIGZsYXNrIGltcG9ydCBCbHVlcHJpbnQsIHJlbmRlcl90ZW1wbGF0ZSwgcmVkaXJlY3QsIHVybF9mb3IsIHNlc3Npb24sIGZsYXNoLCByZXF1ZXN0CmZyb20gZGIgaW1wb3J0IGRiCmZyb20gbW9kZWxzIGltcG9ydCBVc2VyLCBDYW1wYWlnbiwgQ2FtcGFpZ25NZW1iZXJzaGlwLCBDaGFyYWN0ZXIKCmRtX2JwID0gQmx1ZXByaW50KCJkbSIsIF9fbmFtZV9fLCB1cmxfcHJlZml4PSIvZG0iKQoKZGVmIF9yZXF1aXJlX2RtKCk6CiAgICByb2xlID0gc2Vzc2lvbi5nZXQoInJvbGUiKQogICAgaWYgcm9sZSBub3QgaW4gKCJkbSIsICJhZG1pbiIpOgogICAgICAgIGZsYXNoKCJETSBvciBBZG1pbiBhY2Nlc3MgcmVxdWlyZWQuIiwgImVycm9yIikKICAgICAgICByZXR1cm4gRmFsc2UKICAgIHJldHVybiBUcnVlCgpkZWYgX2lzX2FkbWluKCk6CiAgICByZXR1cm4gc2Vzc2lvbi5nZXQoInJvbGUiKSA9PSAiYWRtaW4iCgpkZWYgX293bnNfY2FtcGFpZ24oY2FtcGFpZ246IENhbXBhaWduKSAtPiBib29sOgogICAgaWYgX2lzX2FkbWluKCk6CiAgICAgICAgcmV0dXJuIFRydWUKICAgIHJldHVybiBjYW1wYWlnbi5kbV9pZCA9PSBzZXNzaW9uLmdldCgidXNlcl9pZCIpCgpAZG1fYnAuZ2V0KCIvIikKZGVmIGRhc2hib2FyZCgpOgogICAgaWYgbm90IF9yZXF1aXJlX2RtKCk6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCiAgICB1aWQgPSBzZXNzaW9uLmdldCgidXNlcl9pZCIpCiAgICBpZiBfaXNfYWRtaW4oKToKICAgICAgICBjYW1wYWlnbnMgPSBDYW1wYWlnbi5xdWVyeS5vcmRlcl9ieShDYW1wYWlnbi5jcmVhdGVkX2F0LmRlc2MoKSkuYWxsKCkKICAgIGVsc2U6CiAgICAgICAgY2FtcGFpZ25zID0gQ2FtcGFpZ24ucXVlcnkuZmlsdGVyX2J5KGRtX2lkPXVpZCkub3JkZXJfYnkoQ2FtcGFpZ24uY3JlYXRlZF9hdC5kZXNjKCkpLmFsbCgpCiAgICByZXR1cm4gcmVuZGVyX3RlbXBsYXRlKCJkbS9kYXNoYm9hcmQuaHRtbCIsIGNhbXBhaWducz1jYW1wYWlnbnMpCgpAZG1fYnAucG9zdCgiL2NhbXBhaWducy9jcmVhdGUiKQpkZWYgY3JlYXRlX2NhbXBhaWduKCk6CiAgICBpZiBub3QgX3JlcXVpcmVfZG0oKToKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYXV0aC5sb2dpbl9nZXQiKSkKICAgIG5hbWUgPSAocmVxdWVzdC5mb3JtLmdldCgibmFtZSIpIG9yICIiKS5zdHJpcCgpCiAgICBkZXNjID0gKHJlcXVlc3QuZm9ybS5nZXQoImRlc2NyaXB0aW9uIikgb3IgIiIpLnN0cmlwKCkKICAgIGlmIG5vdCBuYW1lOgogICAgICAgIGZsYXNoKCJDYW1wYWlnbiBuYW1lIHJlcXVpcmVkLiIsICJlcnJvciIpCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImRtLmRhc2hib2FyZCIpKQogICAgdWlkID0gc2Vzc2lvbi5nZXQoInVzZXJfaWQiKQogICAgYyA9IENhbXBhaWduKG5hbWU9bmFtZSwgZGVzY3JpcHRpb249ZGVzYywgZG1faWQ9dWlkKQogICAgZGIuc2Vzc2lvbi5hZGQoYykKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKICAgIG0gPSBDYW1wYWlnbk1lbWJlcnNoaXAoY2FtcGFpZ25faWQ9Yy5pZCwgdXNlcl9pZD11aWQsIHJvbGU9ImRtIiwgYXBwcm92ZWQ9VHJ1ZSkKICAgIGRiLnNlc3Npb24uYWRkKG0pCiAgICBkYi5zZXNzaW9uLmNvbW1pdCgpCiAgICBmbGFzaChmIkNhbXBhaWduICd7bmFtZX0nIGNyZWF0ZWQhIiwgIm9rIikKICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJjYW1wYWlnbnMudmlldyIsIGNpZD1jLmlkKSkKCkBkbV9icC5wb3N0KCIvY2FtcGFpZ25zLzxpbnQ6Y2lkPi9kZWxldGUiKQpkZWYgZGVsZXRlX2NhbXBhaWduKGNpZDogaW50KToKICAgIGlmIG5vdCBfcmVxdWlyZV9kbSgpOgogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhdXRoLmxvZ2luX2dldCIpKQogICAgYyA9IENhbXBhaWduLnF1ZXJ5LmdldF9vcl80MDQoY2lkKQogICAgaWYgbm90IF9vd25zX2NhbXBhaWduKGMpOgogICAgICAgIGZsYXNoKCJZb3UgY2FuIG9ubHkgZGVsZXRlIHlvdXIgb3duIGNhbXBhaWducy4iLCAiZXJyb3IiKQogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJkbS5kYXNoYm9hcmQiKSkKICAgIGRiLnNlc3Npb24uZGVsZXRlKGMpCiAgICBkYi5zZXNzaW9uLmNvbW1pdCgpCiAgICBmbGFzaCgiQ2FtcGFpZ24gZGVsZXRlZC4iLCAib2siKQogICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImRtLmRhc2hib2FyZCIpKQoKQGRtX2JwLnBvc3QoIi9jYW1wYWlnbnMvPGludDpjaWQ+L2FwcHJvdmUvPGludDp1aWQ+IikKZGVmIGFwcHJvdmVfcGxheWVyKGNpZDogaW50LCB1aWQ6IGludCk6CiAgICBpZiBub3QgX3JlcXVpcmVfZG0oKToKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYXV0aC5sb2dpbl9nZXQiKSkKICAgIGMgPSBDYW1wYWlnbi5xdWVyeS5nZXRfb3JfNDA0KGNpZCkKICAgIGlmIG5vdCBfb3duc19jYW1wYWlnbihjKToKICAgICAgICBmbGFzaCgiTm90IHlvdXIgY2FtcGFpZ24uIiwgImVycm9yIikKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiZG0uZGFzaGJvYXJkIikpCiAgICB0YXJnZXRfdXNlciA9IFVzZXIucXVlcnkuZ2V0X29yXzQwNCh1aWQpCiAgICBpZiB0YXJnZXRfdXNlci5yb2xlID09ICJkbSIgYW5kIG5vdCBfaXNfYWRtaW4oKToKICAgICAgICBmbGFzaCgiRE1zIGNhbm5vdCBhcHByb3ZlIG90aGVyIERNcy4gQ29udGFjdCBBZG1pbi4iLCAiZXJyb3IiKQogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJjYW1wYWlnbnMudmlldyIsIGNpZD1jaWQpKQogICAgbSA9IENhbXBhaWduTWVtYmVyc2hpcC5xdWVyeS5maWx0ZXJfYnkoY2FtcGFpZ25faWQ9Y2lkLCB1c2VyX2lkPXVpZCkuZmlyc3Rfb3JfNDA0KCkKICAgIG0uYXBwcm92ZWQgPSBUcnVlCiAgICBkYi5zZXNzaW9uLmNvbW1pdCgpCiAgICBmbGFzaChmInt0YXJnZXRfdXNlci5kaXNwbGF5X25hbWUgb3IgdGFyZ2V0X3VzZXIudXNlcm5hbWV9IGFwcHJvdmVkLiIsICJvayIpCiAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiY2FtcGFpZ25zLnZpZXciLCBjaWQ9Y2lkKSkKCkBkbV9icC5wb3N0KCIvY2FtcGFpZ25zLzxpbnQ6Y2lkPi9raWNrLzxpbnQ6dWlkPiIpCmRlZiBraWNrX3BsYXllcihjaWQ6IGludCwgdWlkOiBpbnQpOgogICAgaWYgbm90IF9yZXF1aXJlX2RtKCk6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCiAgICBjID0gQ2FtcGFpZ24ucXVlcnkuZ2V0X29yXzQwNChjaWQpCiAgICBpZiBub3QgX293bnNfY2FtcGFpZ24oYyk6CiAgICAgICAgZmxhc2goIk5vdCB5b3VyIGNhbXBhaWduLiIsICJlcnJvciIpCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImRtLmRhc2hib2FyZCIpKQogICAgbSA9IENhbXBhaWduTWVtYmVyc2hpcC5xdWVyeS5maWx0ZXJfYnkoY2FtcGFpZ25faWQ9Y2lkLCB1c2VyX2lkPXVpZCkuZmlyc3Rfb3JfNDA0KCkKICAgIGRiLnNlc3Npb24uZGVsZXRlKG0pCiAgICBkYi5zZXNzaW9uLmNvbW1pdCgpCiAgICBmbGFzaCgiUGxheWVyIHJlbW92ZWQgZnJvbSBjYW1wYWlnbi4iLCAib2siKQogICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImNhbXBhaWducy52aWV3IiwgY2lkPWNpZCkpCg=="
[System.IO.File]::WriteAllBytes("$root\routes\dm.py", [System.Convert]::FromBase64String($b))

# routes\admin.py
$b = "ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwpmcm9tIGZsYXNrIGltcG9ydCBCbHVlcHJpbnQsIHJlbmRlcl90ZW1wbGF0ZSwgcmVkaXJlY3QsIHVybF9mb3IsIHNlc3Npb24sIGZsYXNoLCByZXF1ZXN0CmZyb20gZGIgaW1wb3J0IGRiCmZyb20gbW9kZWxzIGltcG9ydCBVc2VyLCBDYW1wYWlnbiwgQ2FtcGFpZ25NZW1iZXJzaGlwLCBDaGFyYWN0ZXIKZnJvbSBzZXJ2aWNlcy5hdXRoX3NlcnZpY2UgaW1wb3J0IGhhc2hfcGFzc3dvcmQKCmFkbWluX2JwID0gQmx1ZXByaW50KCJhZG1pbiIsIF9fbmFtZV9fLCB1cmxfcHJlZml4PSIvYWRtaW4iKQoKZGVmIF9yZXF1aXJlX2FkbWluKCk6CiAgICBpZiBzZXNzaW9uLmdldCgicm9sZSIpICE9ICJhZG1pbiI6CiAgICAgICAgZmxhc2goIkFkbWluIGFjY2VzcyByZXF1aXJlZC4iLCAiZXJyb3IiKQogICAgICAgIHJldHVybiBGYWxzZQogICAgcmV0dXJuIFRydWUKCkBhZG1pbl9icC5nZXQoIi8iKQpkZWYgZGFzaGJvYXJkKCk6CiAgICBpZiBub3QgX3JlcXVpcmVfYWRtaW4oKToKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYXV0aC5sb2dpbl9nZXQiKSkKICAgIHVzZXJzID0gVXNlci5xdWVyeS5vcmRlcl9ieShVc2VyLnJvbGUsIFVzZXIudXNlcm5hbWUpLmFsbCgpCiAgICBjYW1wYWlnbnMgPSBDYW1wYWlnbi5xdWVyeS5vcmRlcl9ieShDYW1wYWlnbi5jcmVhdGVkX2F0LmRlc2MoKSkuYWxsKCkKICAgIHJldHVybiByZW5kZXJfdGVtcGxhdGUoImFkbWluL2Rhc2hib2FyZC5odG1sIiwKICAgICAgICB1c2Vycz11c2VycywgY2FtcGFpZ25zPWNhbXBhaWducywKICAgICAgICB1c2VyX2NvdW50PWxlbih1c2VycyksCiAgICAgICAgY2FtcGFpZ25fY291bnQ9bGVuKGNhbXBhaWducyksCiAgICAgICAgY2hhcl9jb3VudD1DaGFyYWN0ZXIucXVlcnkuY291bnQoKQogICAgKQoKQGFkbWluX2JwLnBvc3QoIi91c2Vycy9jcmVhdGUiKQpkZWYgY3JlYXRlX3VzZXIoKToKICAgIGlmIG5vdCBfcmVxdWlyZV9hZG1pbigpOgogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhdXRoLmxvZ2luX2dldCIpKQogICAgdXNlcm5hbWUgPSAocmVxdWVzdC5mb3JtLmdldCgidXNlcm5hbWUiKSBvciAiIikuc3RyaXAoKQogICAgcGFzc3dvcmQgPSAocmVxdWVzdC5mb3JtLmdldCgicGFzc3dvcmQiKSBvciAiIikuc3RyaXAoKQogICAgcm9sZSA9IChyZXF1ZXN0LmZvcm0uZ2V0KCJyb2xlIikgb3IgInBsYXllciIpLnN0cmlwKCkKICAgIGRpc3BsYXkgPSAocmVxdWVzdC5mb3JtLmdldCgiZGlzcGxheV9uYW1lIikgb3IgdXNlcm5hbWUpLnN0cmlwKCkKCiAgICBpZiBub3QgdXNlcm5hbWUgb3Igbm90IHBhc3N3b3JkOgogICAgICAgIGZsYXNoKCJVc2VybmFtZSBhbmQgcGFzc3dvcmQgcmVxdWlyZWQuIiwgImVycm9yIikKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCiAgICBpZiByb2xlIG5vdCBpbiAoImFkbWluIiwgImRtIiwgInBsYXllciIpOgogICAgICAgIGZsYXNoKCJJbnZhbGlkIHJvbGUuIiwgImVycm9yIikKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCiAgICBpZiBsZW4ocGFzc3dvcmQpIDwgNjoKICAgICAgICBmbGFzaCgiUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA2IGNoYXJhY3RlcnMuIiwgImVycm9yIikKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCiAgICBpZiBVc2VyLnF1ZXJ5LmZpbHRlcl9ieSh1c2VybmFtZT11c2VybmFtZSkuZmlyc3QoKToKICAgICAgICBmbGFzaChmIlVzZXJuYW1lICd7dXNlcm5hbWV9JyBhbHJlYWR5IGV4aXN0cy4iLCAiZXJyb3IiKQogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhZG1pbi5kYXNoYm9hcmQiKSkKCiAgICB1ID0gVXNlcih1c2VybmFtZT11c2VybmFtZSwgcGFzc3dvcmRfaGFzaD1oYXNoX3Bhc3N3b3JkKHBhc3N3b3JkKSwgcm9sZT1yb2xlLCBkaXNwbGF5X25hbWU9ZGlzcGxheSkKICAgIGRiLnNlc3Npb24uYWRkKHUpCiAgICBkYi5zZXNzaW9uLmNvbW1pdCgpCiAgICBmbGFzaChmIlVzZXIgJ3t1c2VybmFtZX0nIGNyZWF0ZWQgYXMge3JvbGV9LiIsICJvayIpCiAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCgpAYWRtaW5fYnAucG9zdCgiL3VzZXJzLzxpbnQ6dWlkPi9zZXRfcm9sZSIpCmRlZiBzZXRfcm9sZSh1aWQ6IGludCk6CiAgICBpZiBub3QgX3JlcXVpcmVfYWRtaW4oKToKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYXV0aC5sb2dpbl9nZXQiKSkKICAgIHUgPSBVc2VyLnF1ZXJ5LmdldF9vcl80MDQodWlkKQogICAgcm9sZSA9IChyZXF1ZXN0LmZvcm0uZ2V0KCJyb2xlIikgb3IgIiIpLnN0cmlwKCkKICAgIGlmIHJvbGUgbm90IGluICgiYWRtaW4iLCAiZG0iLCAicGxheWVyIik6CiAgICAgICAgZmxhc2goIkludmFsaWQgcm9sZS4iLCAiZXJyb3IiKQogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhZG1pbi5kYXNoYm9hcmQiKSkKICAgICMgUHJldmVudCByZW1vdmluZyBsYXN0IGFkbWluCiAgICBpZiB1LnJvbGUgPT0gImFkbWluIiBhbmQgcm9sZSAhPSAiYWRtaW4iOgogICAgICAgIGFkbWluX2NvdW50ID0gVXNlci5xdWVyeS5maWx0ZXJfYnkocm9sZT0iYWRtaW4iKS5jb3VudCgpCiAgICAgICAgaWYgYWRtaW5fY291bnQgPD0gMToKICAgICAgICAgICAgZmxhc2goIkNhbm5vdCBkZW1vdGUgdGhlIGxhc3QgYWRtaW4uIiwgImVycm9yIikKICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImFkbWluLmRhc2hib2FyZCIpKQogICAgdS5yb2xlID0gcm9sZQogICAgZGIuc2Vzc2lvbi5jb21taXQoKQogICAgZmxhc2goZiJ7dS51c2VybmFtZX0gaXMgbm93IHtyb2xlfS4iLCAib2siKQogICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImFkbWluLmRhc2hib2FyZCIpKQoKQGFkbWluX2JwLnBvc3QoIi91c2Vycy88aW50OnVpZD4vcmVzZXRfcGFzc3dvcmQiKQpkZWYgcmVzZXRfcGFzc3dvcmQodWlkOiBpbnQpOgogICAgaWYgbm90IF9yZXF1aXJlX2FkbWluKCk6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCiAgICB1ID0gVXNlci5xdWVyeS5nZXRfb3JfNDA0KHVpZCkKICAgIHB3ID0gKHJlcXVlc3QuZm9ybS5nZXQoInBhc3N3b3JkIikgb3IgIiIpLnN0cmlwKCkKICAgIGlmIG5vdCBwdyBvciBsZW4ocHcpIDwgNjoKICAgICAgICBmbGFzaCgiUGFzc3dvcmQgbXVzdCBiZSBhdCBsZWFzdCA2IGNoYXJhY3RlcnMuIiwgImVycm9yIikKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCiAgICB1LnBhc3N3b3JkX2hhc2ggPSBoYXNoX3Bhc3N3b3JkKHB3KQogICAgZGIuc2Vzc2lvbi5jb21taXQoKQogICAgZmxhc2goZiJQYXNzd29yZCByZXNldCBmb3Ige3UudXNlcm5hbWV9LiIsICJvayIpCiAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCgpAYWRtaW5fYnAucG9zdCgiL3VzZXJzLzxpbnQ6dWlkPi9kZWxldGUiKQpkZWYgZGVsZXRlX3VzZXIodWlkOiBpbnQpOgogICAgaWYgbm90IF9yZXF1aXJlX2FkbWluKCk6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCiAgICB1ID0gVXNlci5xdWVyeS5nZXRfb3JfNDA0KHVpZCkKICAgIGlmIHUuaWQgPT0gc2Vzc2lvbi5nZXQoInVzZXJfaWQiKToKICAgICAgICBmbGFzaCgiWW91IGNhbm5vdCBkZWxldGUgeW91cnNlbGYuIiwgImVycm9yIikKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYWRtaW4uZGFzaGJvYXJkIikpCiAgICBpZiB1LnJvbGUgPT0gImFkbWluIjoKICAgICAgICBhZG1pbl9jb3VudCA9IFVzZXIucXVlcnkuZmlsdGVyX2J5KHJvbGU9ImFkbWluIikuY291bnQoKQogICAgICAgIGlmIGFkbWluX2NvdW50IDw9IDE6CiAgICAgICAgICAgIGZsYXNoKCJDYW5ub3QgZGVsZXRlIHRoZSBsYXN0IGFkbWluLiIsICJlcnJvciIpCiAgICAgICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhZG1pbi5kYXNoYm9hcmQiKSkKICAgIGRiLnNlc3Npb24uZGVsZXRlKHUpCiAgICBkYi5zZXNzaW9uLmNvbW1pdCgpCiAgICBmbGFzaChmIlVzZXIgJ3t1LnVzZXJuYW1lfScgZGVsZXRlZC4iLCAib2siKQogICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImFkbWluLmRhc2hib2FyZCIpKQoKQGFkbWluX2JwLnBvc3QoIi9jYW1wYWlnbnMvPGludDpjaWQ+L2RlbGV0ZSIpCmRlZiBkZWxldGVfY2FtcGFpZ24oY2lkOiBpbnQpOgogICAgaWYgbm90IF9yZXF1aXJlX2FkbWluKCk6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCiAgICBjID0gQ2FtcGFpZ24ucXVlcnkuZ2V0X29yXzQwNChjaWQpCiAgICBkYi5zZXNzaW9uLmRlbGV0ZShjKQogICAgZGIuc2Vzc2lvbi5jb21taXQoKQogICAgZmxhc2goZiJDYW1wYWlnbiAne2MubmFtZX0nIGRlbGV0ZWQuIiwgIm9rIikKICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhZG1pbi5kYXNoYm9hcmQiKSkK"
[System.IO.File]::WriteAllBytes("$root\routes\admin.py", [System.Convert]::FromBase64String($b))

# routes\characters.py
$b = "ZnJvbSBfX2Z1dHVyZV9fIGltcG9ydCBhbm5vdGF0aW9ucwppbXBvcnQganNvbgpmcm9tIGZsYXNrIGltcG9ydCBCbHVlcHJpbnQsIHJlbmRlcl90ZW1wbGF0ZSwgcmVkaXJlY3QsIHVybF9mb3IsIHNlc3Npb24sIGZsYXNoLCByZXF1ZXN0LCBqc29uaWZ5LCBjdXJyZW50X2FwcApmcm9tIGRiIGltcG9ydCBkYgpmcm9tIG1vZGVscyBpbXBvcnQgQ2hhcmFjdGVyLCBDYW1wYWlnbiwgQ2FtcGFpZ25NZW1iZXJzaGlwCmZyb20gc2VydmljZXMgaW1wb3J0IHNyZF9zZXJ2aWNlLCBvbGxhbWFfc2VydmljZQoKY2hhcmFjdGVyc19icCA9IEJsdWVwcmludCgiY2hhcmFjdGVycyIsIF9fbmFtZV9fLCB1cmxfcHJlZml4PSIvY2hhcmFjdGVycyIpCgpkZWYgX3JlcXVpcmVfbG9naW4oKToKICAgIGlmIG5vdCBzZXNzaW9uLmdldCgidXNlcl9pZCIpOgogICAgICAgIGZsYXNoKCJQbGVhc2UgbG9nIGluLiIsICJlcnJvciIpCiAgICAgICAgcmV0dXJuIEZhbHNlCiAgICByZXR1cm4gVHJ1ZQoKZGVmIF9jYW5fZWRpdF9jaGFyYWN0ZXIoY2hhcjogQ2hhcmFjdGVyKSAtPiBib29sOgogICAgdWlkID0gc2Vzc2lvbi5nZXQoInVzZXJfaWQiKQogICAgcm9sZSA9IHNlc3Npb24uZ2V0KCJyb2xlIikKICAgICMgQWRtaW4gY2FuIGVkaXQgYW55dGhpbmcKICAgIGlmIHJvbGUgPT0gImFkbWluIjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgIyBETSBjYW4gZWRpdCBjaGFyYWN0ZXJzIGluIHRoZWlyIG93biBjYW1wYWlnbnMKICAgIGlmIHJvbGUgPT0gImRtIjoKICAgICAgICBpZiBjaGFyLmNhbXBhaWduX2lkOgogICAgICAgICAgICBjYW1wYWlnbiA9IENhbXBhaWduLnF1ZXJ5LmdldChjaGFyLmNhbXBhaWduX2lkKQogICAgICAgICAgICBpZiBjYW1wYWlnbiBhbmQgY2FtcGFpZ24uZG1faWQgPT0gdWlkOgogICAgICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICAjIERNIGNhbiBhbHdheXMgZWRpdCBOUENzIHRoZXkgY3JlYXRlZAogICAgICAgIGlmIGNoYXIuaXNfbnBjIGFuZCBjaGFyLm93bmVyX2lkID09IHVpZDoKICAgICAgICAgICAgcmV0dXJuIFRydWUKICAgICAgICByZXR1cm4gRmFsc2UKICAgICMgUGxheWVycyBjYW4gT05MWSBlZGl0IHRoZWlyIG93biBjaGFyYWN0ZXJzCiAgICByZXR1cm4gY2hhci5vd25lcl9pZCA9PSB1aWQKCmRlZiBfY2FuX2RlbGV0ZV9jaGFyYWN0ZXIoY2hhcjogQ2hhcmFjdGVyKSAtPiBib29sOgogICAgdWlkID0gc2Vzc2lvbi5nZXQoInVzZXJfaWQiKQogICAgcm9sZSA9IHNlc3Npb24uZ2V0KCJyb2xlIikKICAgIGlmIHJvbGUgPT0gImFkbWluIjoKICAgICAgICByZXR1cm4gVHJ1ZQogICAgaWYgcm9sZSA9PSAiZG0iOgogICAgICAgIGlmIGNoYXIuY2FtcGFpZ25faWQ6CiAgICAgICAgICAgIGNhbXBhaWduID0gQ2FtcGFpZ24ucXVlcnkuZ2V0KGNoYXIuY2FtcGFpZ25faWQpCiAgICAgICAgICAgIGlmIGNhbXBhaWduIGFuZCBjYW1wYWlnbi5kbV9pZCA9PSB1aWQ6CiAgICAgICAgICAgICAgICByZXR1cm4gVHJ1ZQogICAgICAgIHJldHVybiBGYWxzZQogICAgIyBQbGF5ZXJzIGNhbiBvbmx5IGRlbGV0ZSB0aGVpciBvd24gY2hhcmFjdGVycwogICAgcmV0dXJuIGNoYXIub3duZXJfaWQgPT0gdWlkIGFuZCBub3QgY2hhci5pc19ucGMKCkBjaGFyYWN0ZXJzX2JwLmdldCgiL25ldyIpCmRlZiBuZXcoKToKICAgIGlmIG5vdCBfcmVxdWlyZV9sb2dpbigpOgogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhdXRoLmxvZ2luX2dldCIpKQogICAgY2FtcGFpZ25faWQgPSByZXF1ZXN0LmFyZ3MuZ2V0KCJjYW1wYWlnbl9pZCIsIHR5cGU9aW50KQogICAgaXNfbnBjID0gcmVxdWVzdC5hcmdzLmdldCgibnBjIiwgImZhbHNlIikubG93ZXIoKSA9PSAidHJ1ZSIKICAgIHJvbGUgPSBzZXNzaW9uLmdldCgicm9sZSIpCgogICAgaWYgaXNfbnBjIGFuZCByb2xlIG5vdCBpbiAoImRtIiwgImFkbWluIik6CiAgICAgICAgZmxhc2goIk9ubHkgRE1zIGFuZCBBZG1pbnMgY2FuIGNyZWF0ZSBOUENzLiIsICJlcnJvciIpCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCgogICAgIyBQbGF5ZXJzIG11c3QgYmUgYW4gYXBwcm92ZWQgbWVtYmVyIG9mIHRoZSBjYW1wYWlnbiB0byBjcmVhdGUgYSBjaGFyYWN0ZXIgdGhlcmUKICAgIGlmIG5vdCBpc19ucGMgYW5kIHJvbGUgPT0gInBsYXllciIgYW5kIGNhbXBhaWduX2lkOgogICAgICAgIHVpZCA9IHNlc3Npb24uZ2V0KCJ1c2VyX2lkIikKICAgICAgICBtID0gQ2FtcGFpZ25NZW1iZXJzaGlwLnF1ZXJ5LmZpbHRlcl9ieShjYW1wYWlnbl9pZD1jYW1wYWlnbl9pZCwgdXNlcl9pZD11aWQsIGFwcHJvdmVkPVRydWUpLmZpcnN0KCkKICAgICAgICBpZiBub3QgbToKICAgICAgICAgICAgZmxhc2goIllvdSBtdXN0IGJlIGFuIGFwcHJvdmVkIGNhbXBhaWduIG1lbWJlciB0byBjcmVhdGUgYSBjaGFyYWN0ZXIgdGhlcmUuIiwgImVycm9yIikKICAgICAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoInBsYXllci5kYXNoYm9hcmQiKSkKCiAgICByZXR1cm4gcmVuZGVyX3RlbXBsYXRlKCJjaGFyYWN0ZXJzL3dpemFyZC5odG1sIiwKICAgICAgICBjYW1wYWlnbl9pZD1jYW1wYWlnbl9pZCwKICAgICAgICBpc19ucGM9aXNfbnBjLAogICAgICAgIHJhY2VzPXNyZF9zZXJ2aWNlLlNSRF9SQUNFUywKICAgICAgICBjbGFzc2VzPXNyZF9zZXJ2aWNlLlNSRF9DTEFTU0VTLAogICAgICAgIGJhY2tncm91bmRzPXNyZF9zZXJ2aWNlLlNSRF9CQUNLR1JPVU5EUywKICAgICAgICBhbGlnbm1lbnRzPXNyZF9zZXJ2aWNlLlNSRF9BTElHTk1FTlRTLAogICAgICAgIHNraWxscz1zcmRfc2VydmljZS5BTExfU0tJTExTLAogICAgICAgIG9sbGFtYV9vaz1vbGxhbWFfc2VydmljZS5vbGxhbWFfaGVhbHRoKGN1cnJlbnRfYXBwLmNvbmZpZ1siT0xMQU1BX1VSTCJdKSwKICAgICkKCkBjaGFyYWN0ZXJzX2JwLnBvc3QoIi9jcmVhdGUiKQpkZWYgY3JlYXRlKCk6CiAgICBpZiBub3QgX3JlcXVpcmVfbG9naW4oKToKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiYXV0aC5sb2dpbl9nZXQiKSkKICAgIHVpZCA9IHNlc3Npb24uZ2V0KCJ1c2VyX2lkIikKICAgIHJvbGUgPSBzZXNzaW9uLmdldCgicm9sZSIpCiAgICBmID0gcmVxdWVzdC5mb3JtCiAgICBjYW1wYWlnbl9pZCA9IGYuZ2V0KCJjYW1wYWlnbl9pZCIsIHR5cGU9aW50KQogICAgaXNfbnBjID0gZi5nZXQoImlzX25wYyIsICJmYWxzZSIpLmxvd2VyKCkgPT0gInRydWUiCgogICAgaWYgaXNfbnBjIGFuZCByb2xlIG5vdCBpbiAoImRtIiwgImFkbWluIik6CiAgICAgICAgZmxhc2goIk9ubHkgRE1zIGFuZCBBZG1pbnMgY2FuIGNyZWF0ZSBOUENzLiIsICJlcnJvciIpCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCgogICAgZGVmIHNjb3JlKGtleSk6IHJldHVybiBtYXgoMSwgbWluKDIwLCBpbnQoZi5nZXQoa2V5LCAxMCkgb3IgMTApKSkKCiAgICByYWNlX25hbWUgPSBmLmdldCgicmFjZSIsICJIdW1hbiIpCiAgICBjbGFzc19uYW1lID0gZi5nZXQoImNoYXJfY2xhc3MiLCAiRmlnaHRlciIpCiAgICBiZ19uYW1lID0gZi5nZXQoImJhY2tncm91bmQiLCAiU29sZGllciIpCiAgICBsZXZlbCA9IG1heCgxLCBtaW4oMjAsIGludChmLmdldCgibGV2ZWwiLCAxKSBvciAxKSkpCgogICAgc3JkX2NsYXNzID0gc3JkX3NlcnZpY2UuZ2V0X2NsYXNzKGNsYXNzX25hbWUpIG9yIHt9CiAgICBoaXRfZGllID0gc3JkX2NsYXNzLmdldCgiaGl0X2RpZSIsICJkOCIpCiAgICBwcm9mID0gc3JkX3NlcnZpY2UucHJvZmljaWVuY3lfYm9udXMobGV2ZWwpCiAgICBjb25fbW9kID0gc3JkX3NlcnZpY2UuYWJpbGl0eV9tb2RpZmllcihzY29yZSgiY29uc3RpdHV0aW9uIikpCiAgICBoaXRfZGllX3ZhbCA9IGludChoaXRfZGllWzE6XSkKICAgIG1heF9ocCA9IGhpdF9kaWVfdmFsICsgY29uX21vZCArIChsZXZlbCAtIDEpICogKGhpdF9kaWVfdmFsIC8vIDIgKyAxICsgY29uX21vZCkKICAgIG1heF9ocCA9IG1heCgxLCBtYXhfaHApCgogICAgY2hhciA9IENoYXJhY3RlcigKICAgICAgICBvd25lcl9pZD11aWQgaWYgbm90IGlzX25wYyBlbHNlIE5vbmUsCiAgICAgICAgY2FtcGFpZ25faWQ9Y2FtcGFpZ25faWQsCiAgICAgICAgaXNfbnBjPWlzX25wYywKICAgICAgICBuYW1lPWYuZ2V0KCJuYW1lIiwgIih1bm5hbWVkKSIpLnN0cmlwKCkgb3IgIih1bm5hbWVkKSIsCiAgICAgICAgbGV2ZWw9bGV2ZWwsCiAgICAgICAgY2hhcl9jbGFzcz1jbGFzc19uYW1lLAogICAgICAgIHJhY2U9cmFjZV9uYW1lLAogICAgICAgIGJhY2tncm91bmQ9YmdfbmFtZSwKICAgICAgICBhbGlnbm1lbnQ9Zi5nZXQoImFsaWdubWVudCIsICJUcnVlIE5ldXRyYWwiKSwKICAgICAgICBzdHJlbmd0aD1zY29yZSgic3RyZW5ndGgiKSwKICAgICAgICBkZXh0ZXJpdHk9c2NvcmUoImRleHRlcml0eSIpLAogICAgICAgIGNvbnN0aXR1dGlvbj1zY29yZSgiY29uc3RpdHV0aW9uIiksCiAgICAgICAgaW50ZWxsaWdlbmNlPXNjb3JlKCJpbnRlbGxpZ2VuY2UiKSwKICAgICAgICB3aXNkb209c2NvcmUoIndpc2RvbSIpLAogICAgICAgIGNoYXJpc21hPXNjb3JlKCJjaGFyaXNtYSIpLAogICAgICAgIG1heF9ocD1tYXhfaHAsCiAgICAgICAgY3VycmVudF9ocD1tYXhfaHAsCiAgICAgICAgYXJtb3JfY2xhc3M9MTAgKyBzcmRfc2VydmljZS5hYmlsaXR5X21vZGlmaWVyKHNjb3JlKCJkZXh0ZXJpdHkiKSksCiAgICAgICAgc3BlZWQ9MzAsCiAgICAgICAgcHJvZmljaWVuY3lfYm9udXM9cHJvZiwKICAgICAgICBoaXRfZGljZT1mIntsZXZlbH17aGl0X2RpZX0iLAogICAgICAgIGJ1aWxkX2NvbXBsZXRlPVRydWUsCiAgICAgICAgbm90ZXM9Zi5nZXQoIm5vdGVzIiwgIiIpLAogICAgKQoKICAgIGJnID0gc3JkX3NlcnZpY2UuZ2V0X2JhY2tncm91bmQoYmdfbmFtZSkgb3Ige30KICAgIGNoYXIuc2tpbGxzX2pzb24gPSBqc29uLmR1bXBzKHtzOiBUcnVlIGZvciBzIGluIGJnLmdldCgic2tpbGxfcHJvZmljaWVuY2llcyIsIFtdKX0pCiAgICBjaGFyLmVxdWlwbWVudF9qc29uID0ganNvbi5kdW1wcyhiZy5nZXQoImVxdWlwbWVudCIsIFtdKSkKCiAgICBmZWF0cyA9IFtdCiAgICBmb3IgbHZsIGluIHJhbmdlKDEsIGxldmVsICsgMSk6CiAgICAgICAgZmVhdHMuZXh0ZW5kKHNyZF9jbGFzcy5nZXQoImZlYXR1cmVzX2J5X2xldmVsIiwge30pLmdldChsdmwsIFtdKSkKICAgIGNoYXIuZmVhdHVyZXNfanNvbiA9IGpzb24uZHVtcHMoZmVhdHMpCgogICAgZGIuc2Vzc2lvbi5hZGQoY2hhcikKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKCiAgICBmbGFzaChmInsnTlBDJyBpZiBpc19ucGMgZWxzZSAnQ2hhcmFjdGVyJ30gJ3tjaGFyLm5hbWV9JyBjcmVhdGVkISIsICJvayIpCiAgICBpZiBjYW1wYWlnbl9pZDoKICAgICAgICByZXR1cm4gcmVkaXJlY3QodXJsX2ZvcigiY2FtcGFpZ25zLnZpZXciLCBjaWQ9Y2FtcGFpZ25faWQpKQogICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImNoYXJhY3RlcnMuc2hlZXQiLCBjaWQ9Y2hhci5pZCkpCgpAY2hhcmFjdGVyc19icC5nZXQoIi88aW50OmNpZD4vc2hlZXQiKQpkZWYgc2hlZXQoY2lkOiBpbnQpOgogICAgaWYgbm90IF9yZXF1aXJlX2xvZ2luKCk6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImF1dGgubG9naW5fZ2V0IikpCiAgICBjaGFyID0gQ2hhcmFjdGVyLnF1ZXJ5LmdldF9vcl80MDQoY2lkKQogICAgY2FuX2VkaXQgPSBfY2FuX2VkaXRfY2hhcmFjdGVyKGNoYXIpCiAgICBjYW5fZGVsZXRlID0gX2Nhbl9kZWxldGVfY2hhcmFjdGVyKGNoYXIpCiAgICByZXR1cm4gcmVuZGVyX3RlbXBsYXRlKCJjaGFyYWN0ZXJzL3NoZWV0Lmh0bWwiLAogICAgICAgIGNoYXI9Y2hhciwgZGF0YT1jaGFyLnRvX3NoZWV0X2RpY3QoKSwKICAgICAgICBjYW5fZWRpdD1jYW5fZWRpdCwgY2FuX2RlbGV0ZT1jYW5fZGVsZXRlKQoKQGNoYXJhY3RlcnNfYnAucG9zdCgiLzxpbnQ6Y2lkPi9kZWxldGUiKQpkZWYgZGVsZXRlKGNpZDogaW50KToKICAgIGlmIG5vdCBfcmVxdWlyZV9sb2dpbigpOgogICAgICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJhdXRoLmxvZ2luX2dldCIpKQogICAgY2hhciA9IENoYXJhY3Rlci5xdWVyeS5nZXRfb3JfNDA0KGNpZCkKICAgIGlmIG5vdCBfY2FuX2RlbGV0ZV9jaGFyYWN0ZXIoY2hhcik6CiAgICAgICAgZmxhc2goIllvdSBkb24ndCBoYXZlIHBlcm1pc3Npb24gdG8gZGVsZXRlIHRoaXMgY2hhcmFjdGVyLiIsICJlcnJvciIpCiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImNoYXJhY3RlcnMuc2hlZXQiLCBjaWQ9Y2lkKSkKICAgIGNhbXBhaWduX2lkID0gY2hhci5jYW1wYWlnbl9pZAogICAgZGIuc2Vzc2lvbi5kZWxldGUoY2hhcikKICAgIGRiLnNlc3Npb24uY29tbWl0KCkKICAgIGZsYXNoKCJDaGFyYWN0ZXIgZGVsZXRlZC4iLCAib2siKQogICAgaWYgY2FtcGFpZ25faWQ6CiAgICAgICAgcmV0dXJuIHJlZGlyZWN0KHVybF9mb3IoImNhbXBhaWducy52aWV3IiwgY2lkPWNhbXBhaWduX2lkKSkKICAgIHJldHVybiByZWRpcmVjdCh1cmxfZm9yKCJwbGF5ZXIuZGFzaGJvYXJkIikpCgpAY2hhcmFjdGVyc19icC5wb3N0KCIvYWlfc3VnZ2VzdCIpCmRlZiBhaV9zdWdnZXN0KCk6CiAgICBpZiBub3Qgc2Vzc2lvbi5nZXQoInVzZXJfaWQiKToKICAgICAgICByZXR1cm4ganNvbmlmeSh7ImVycm9yIjogIk5vdCBsb2dnZWQgaW4ifSksIDQwMQogICAgZGF0YSA9IHJlcXVlc3QuanNvbiBvciB7fQogICAgc3RlcCA9IGRhdGEuZ2V0KCJzdGVwIiwgImdlbmVyYWwiKQogICAgY2hhcl9kYXRhID0gZGF0YS5nZXQoImNoYXJhY3RlciIsIHt9KQogICAgdXJsID0gY3VycmVudF9hcHAuY29uZmlnWyJPTExBTUFfVVJMIl0KICAgIG1vZGVsID0gY3VycmVudF9hcHAuY29uZmlnWyJPTExBTUFfTU9ERUwiXQogICAgc3JkX2N0eCA9IGYiUmFjZXM6IHtbclsnbmFtZSddIGZvciByIGluIHNyZF9zZXJ2aWNlLlNSRF9SQUNFU119XG5DbGFzc2VzOiB7W2NbJ25hbWUnXSBmb3IgYyBpbiBzcmRfc2VydmljZS5TUkRfQ0xBU1NFU119XG5CYWNrZ3JvdW5kczoge1tiWyduYW1lJ10gZm9yIGIgaW4gc3JkX3NlcnZpY2UuU1JEX0JBQ0tHUk9VTkRTXX0iCiAgICBzeXN0ZW0gPSBvbGxhbWFfc2VydmljZS5idWlsZF9jaGFyYWN0ZXJfc3lzdGVtX3Byb21wdChzdGVwLCBjaGFyX2RhdGEsIHNyZF9jdHgpCiAgICB1c2VyX21zZyA9IGRhdGEuZ2V0KCJtZXNzYWdlIiwgZiJIZWxwIG1lIHdpdGggdGhlIHtzdGVwfSBzdGVwIG9mIGNoYXJhY3RlciBjcmVhdGlvbi4iKQogICAgcmVwbHkgPSBvbGxhbWFfc2VydmljZS5vbGxhbWFfY2hhdCh1cmwsIG1vZGVsLCBzeXN0ZW0sIHVzZXJfbXNnKQogICAgcmV0dXJuIGpzb25pZnkoeyJyZXBseSI6IHJlcGx5fSkK"
[System.IO.File]::WriteAllBytes("$root\routes\characters.py", [System.Convert]::FromBase64String($b))

# templates\base.html
$b = "PCFkb2N0eXBlIGh0bWw+CjxodG1sIGxhbmc9ImVuIj4KPGhlYWQ+CiAgPG1ldGEgY2hhcnNldD0idXRmLTgiPgogIDxtZXRhIG5hbWU9InZpZXdwb3J0IiBjb250ZW50PSJ3aWR0aD1kZXZpY2Utd2lkdGgsIGluaXRpYWwtc2NhbGU9MSI+CiAgPHRpdGxlPnslIGJsb2NrIHRpdGxlICV9Q2hhcmFjdGVyRm9yZ2V7JSBlbmRibG9jayAlfTwvdGl0bGU+CiAgPGxpbmsgcmVsPSJwcmVjb25uZWN0IiBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tIj4KICA8bGluayBocmVmPSJodHRwczovL2ZvbnRzLmdvb2dsZWFwaXMuY29tL2NzczI/ZmFtaWx5PUNpbnplbDp3Z2h0QDQwMDs2MDA7NzAwJmZhbWlseT1Dcmltc29uK1RleHQ6aXRhbCx3Z2h0QDAsNDAwOzAsNjAwOzEsNDAwJmRpc3BsYXk9c3dhcCIgcmVsPSJzdHlsZXNoZWV0Ij4KICA8bGluayByZWw9InN0eWxlc2hlZXQiIGhyZWY9Ii9zdGF0aWMvY3NzL2FwcC5jc3MiPgo8L2hlYWQ+Cjxib2R5PgogIHslIGlmIHNlc3Npb24uZ2V0KCd1c2VyX2lkJykgJX0KICA8bmF2IGNsYXNzPSJ0b3BuYXYiPgogICAgPGRpdiBjbGFzcz0ibmF2LWJyYW5kIj7impQgQ2hhcmFjdGVyRm9yZ2U8L2Rpdj4KICAgIDxkaXYgY2xhc3M9Im5hdi1saW5rcyI+CiAgICAgIHslIGlmIHNlc3Npb24uZ2V0KCdyb2xlJykgPT0gJ2FkbWluJyAlfQogICAgICAgIDxhIGhyZWY9Ii9hZG1pbi8iPuKamSBBZG1pbjwvYT4KICAgICAgICA8YSBocmVmPSIvZG0vIj7wn46yIENhbXBhaWduczwvYT4KICAgICAgICA8YSBocmVmPSIvcGxheWVyL2NhbXBhaWducy9icm93c2UiPkJyb3dzZTwvYT4KICAgICAgeyUgZWxpZiBzZXNzaW9uLmdldCgncm9sZScpID09ICdkbScgJX0KICAgICAgICA8YSBocmVmPSIvZG0vIj7wn46yIE15IENhbXBhaWduczwvYT4KICAgICAgICA8YSBocmVmPSIvcGxheWVyL2NhbXBhaWducy9icm93c2UiPkJyb3dzZTwvYT4KICAgICAgeyUgZWxzZSAlfQogICAgICAgIDxhIGhyZWY9Ii9wbGF5ZXIvIj7impQgTXkgQ2FtcGFpZ25zPC9hPgogICAgICAgIDxhIGhyZWY9Ii9wbGF5ZXIvY2FtcGFpZ25zL2Jyb3dzZSI+QnJvd3NlPC9hPgogICAgICB7JSBlbmRpZiAlfQogICAgPC9kaXY+CiAgICA8ZGl2IGNsYXNzPSJuYXYtdXNlciI+CiAgICAgIDxzcGFuIGNsYXNzPSJiYWRnZSBiYWRnZS17eyBzZXNzaW9uLmdldCgncm9sZScpIH19Ij57eyBzZXNzaW9uLmdldCgncm9sZScsICcnKS51cHBlcigpIH19PC9zcGFuPgogICAgICA8c3BhbiBjbGFzcz0ibmF2LW5hbWUiPnt7IHNlc3Npb24uZ2V0KCdkaXNwbGF5X25hbWUnLCBzZXNzaW9uLmdldCgndXNlcm5hbWUnLCAnJykpIH19PC9zcGFuPgogICAgICA8YSBocmVmPSIvYXV0aC9sb2dvdXQiIGNsYXNzPSJidG4tbG9nb3V0Ij5Mb2dvdXQ8L2E+CiAgICA8L2Rpdj4KICA8L25hdj4KICB7JSBlbmRpZiAlfQoKICA8ZGl2IGNsYXNzPSJwYWdlLXdyYXAiPgogICAgeyUgd2l0aCBtc2dzID0gZ2V0X2ZsYXNoZWRfbWVzc2FnZXMod2l0aF9jYXRlZ29yaWVzPXRydWUpICV9CiAgICAgIHslIGlmIG1zZ3MgJX0KICAgICAgICA8ZGl2IGNsYXNzPSJmbGFzaC13cmFwIj4KICAgICAgICAgIHslIGZvciBjYXQsIG1zZyBpbiBtc2dzICV9CiAgICAgICAgICAgIDxkaXYgY2xhc3M9ImZsYXNoIGZsYXNoLXt7IGNhdCB9fSI+e3sgbXNnIH19PC9kaXY+CiAgICAgICAgICB7JSBlbmRmb3IgJX0KICAgICAgICA8L2Rpdj4KICAgICAgeyUgZW5kaWYgJX0KICAgIHslIGVuZHdpdGggJX0KCiAgICB7JSBibG9jayBjb250ZW50ICV9eyUgZW5kYmxvY2sgJX0KICA8L2Rpdj4KCiAgPHNjcmlwdCBzcmM9Ii9zdGF0aWMvanMvYXBwLmpzIj48L3NjcmlwdD4KICB7JSBibG9jayBzY3JpcHRzICV9eyUgZW5kYmxvY2sgJX0KPC9ib2R5Pgo8L2h0bWw+Cg=="
[System.IO.File]::WriteAllBytes("$root\templates\base.html", [System.Convert]::FromBase64String($b))

Write-Host "Patch applied! Restart app.py to take effect." -ForegroundColor Green